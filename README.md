# ğŸ¨ Accommodation Monitor

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Node.js](https://img.shields.io/badge/Node.js-20%2B-green.svg)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue.svg)](https://www.typescriptlang.org/)
[![Next.js](https://img.shields.io/badge/Next.js-15-black.svg)](https://nextjs.org/)

Airbnb, Agoda ìˆ™ì†Œì˜ **ì˜ˆì•½ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§**í•˜ê³ , ì˜ˆì•½ì´ ê°€ëŠ¥í•´ì§€ë©´ **ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì•Œë¦¼**ì„ ë³´ë‚´ì£¼ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

> ì¸ê¸° ìˆ™ì†Œì˜ ì·¨ì†Œ ê±´ì„ ì¡ê¸° ìœ„í•´ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ğŸ‡¨ğŸ‡­

---

## ğŸ“– ëª©ì°¨

- [ì£¼ìš” ê¸°ëŠ¥](#-ì£¼ìš”-ê¸°ëŠ¥)
- [ë²„ì „ íˆìŠ¤í† ë¦¬](#-ë²„ì „-íˆìŠ¤í† ë¦¬)
- [ê¸°ìˆ  ìŠ¤íƒ](#-ê¸°ìˆ -ìŠ¤íƒ)
- [ìš”êµ¬ì‚¬í•­](#-ìš”êµ¬ì‚¬í•­)
- [ë¡œì»¬ ê°œë°œ](#-ë¡œì»¬-ê°œë°œ)
- [í™˜ê²½ë³€ìˆ˜](#-í™˜ê²½ë³€ìˆ˜)
- [í”„ë¡œì íŠ¸ êµ¬ì¡°](#-í”„ë¡œì íŠ¸-êµ¬ì¡°)
- [Contributing](#-contributing)
- [ë¼ì´ì„¼ìŠ¤](#-ë¼ì´ì„¼ìŠ¤)

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

- **ì¹´ì¹´ì˜¤ / êµ¬ê¸€ ì†Œì…œ ë¡œê·¸ì¸**
- **ë©€í‹° ìœ ì € ì§€ì›** â€“ ê°ì ìì‹ ì˜ ìˆ™ì†Œë§Œ ê´€ë¦¬
- **ìˆ™ì†Œ CRUD** â€“ UIë¡œ ì‰½ê²Œ ë“±ë¡ / ìˆ˜ì • / ì‚­ì œ
- **ìë™ ëª¨ë‹ˆí„°ë§** â€“ ì„¤ì • ì£¼ê¸°ì— ë”°ë¼ ìë™ ì²´í¬
- **ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼** â€“ ì˜ˆì•½ ê°€ëŠ¥ ì‹œ ì¦‰ì‹œ ì•Œë¦¼
- **ì²´í¬ ë¡œê·¸** â€“ ëª¨ë‹ˆí„°ë§ íˆìŠ¤í† ë¦¬ í™•ì¸
- **ë¸Œë¼ìš°ì € í’€** â€“ Chromium ì¸ìŠ¤í„´ìŠ¤ ì¬ì‚¬ìš©ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”

---

## ğŸ“¦ ë²„ì „ íˆìŠ¤í† ë¦¬

### v2.2.0 â€“ Google Analytics ë° SEO

- Google Analytics í†µí•©
- SEO ê²€ì¦ìš© í™˜ê²½ë³€ìˆ˜ ì¶”ê°€

**ì‹ ê·œ í™˜ê²½ë³€ìˆ˜**: `NEXT_PUBLIC_GA_ID`, `GOOGLE_SITE_VERIFICATION`, `NAVER_SITE_VERIFICATION`

### v2.1.0 â€“ ë¸Œë¼ìš°ì € í’€ ë„ì… ë° ì„±ëŠ¥ ê°œì„ 

ì²´í¬ë§ˆë‹¤ Chromiumì„ ìƒˆë¡œ ë„ìš°ì§€ ì•Šê³  **ë¸Œë¼ìš°ì € í’€ì„ í†µí•´ ì¬ì‚¬ìš©**í•©ë‹ˆë‹¤.

**ì„±ëŠ¥ ê°œì„ **

- 4ê°œ ìˆ™ì†Œ ì²˜ë¦¬ ì‹œê°„: **40~50ì´ˆ â†’ 12~14ì´ˆ** (ì•½ 65~76% ë‹¨ì¶•)

**ì£¼ìš” ë³€ê²½ ì‚¬í•­**

| í•­ëª©           | ë‚´ìš©                                                                                                                                                  |
| -------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| ğŸŠ ë¸Œë¼ìš°ì € í’€ | `browserPool.ts` ì‹ ê·œ ìƒì„±, ë™ì‹œ ì²˜ë¦¬ ìˆ˜ë¥¼ í’€ í¬ê¸°ë¡œ ìë™ ì œí•œí•´ ë©”ëª¨ë¦¬ í­ì£¼ ë°©ì§€                                                                     |
| âš¡ ì²´í¬ ë¡œì§   | `waitUntil: "domcontentloaded"` ì „í™˜, `CONTENT_WAIT_MS` ëŒ€ê¸° í›„ `PATTERN_RETRY_MS` ê°„ê²©ìœ¼ë¡œ 1íšŒ ì¬í™•ì¸ (CSR ë Œë” ëŒ€ì‘), íŒ¨í„´ ë¯¸íƒì§€ ì‹œ `ERROR`ë¡œ ê¸°ë¡ |
| â±ï¸ íƒ€ì„ì•„ì›ƒ    | `NAVIGATION_TIMEOUT_MS` ê¸°ë³¸ê°’ 25ì´ˆë¡œ ë‹¨ì¶•, Navigation timeout ë°œìƒ ì‹œ ì¬ì‹œë„ ì œì™¸                                                                    |
| ğŸš« ë¦¬ì†ŒìŠ¤ ì°¨ë‹¨ | `BLOCK_RESOURCE_TYPES` í™˜ê²½ë³€ìˆ˜ë¡œ ì´ë¯¸ì§€/ë¯¸ë””ì–´/í°íŠ¸ ìš”ì²­ ì°¨ë‹¨ (ì˜µì…˜)                                                                                 |

**ìš´ì˜ ê¸°ë³¸ê°’ ë³€ê²½**

- `CRON_SCHEDULE`: `*/30 * * * *`
- `WORKER_CONCURRENCY`: `1`
- `BROWSER_POOL_SIZE`: `1`

**ì‹ ê·œ í™˜ê²½ë³€ìˆ˜**: `BROWSER_POOL_SIZE`, `BLOCK_RESOURCE_TYPES`, `NAVIGATION_TIMEOUT_MS`, `CONTENT_WAIT_MS`, `PATTERN_RETRY_MS`

### v2.0.0 â€“ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „í™˜

> v1.x CLI ë„êµ¬ì—ì„œ ì™„ì „íˆ ì¬ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

| v1.x                  | v2.0.0                 |
| --------------------- | ---------------------- |
| CLI ê¸°ë°˜              | í’€ ì›¹ UI               |
| `config.js` ì§ì ‘ í¸ì§‘ | ë¸Œë¼ìš°ì €ì—ì„œ ìˆ™ì†Œ ê´€ë¦¬ |
| ë‹¨ì¼ ì‚¬ìš©ì           | ë©€í‹° ìœ ì € (OAuth)      |
| -                     | PostgreSQL + ì²´í¬ ë¡œê·¸ |
| -                     | Docker Compose ë°°í¬    |

---

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

| ë¶„ë¥˜         | ê¸°ìˆ                                            |
| ------------ | ---------------------------------------------- |
| **Frontend** | Next.js 15, React 19, TypeScript, Tailwind CSS |
| **Backend**  | Next.js API Routes, Prisma ORM                 |
| **Database** | PostgreSQL                                     |
| **Auth**     | NextAuth.js (ì¹´ì¹´ì˜¤, êµ¬ê¸€)                     |
| **Scraping** | Puppeteer                                      |
| **Worker**   | Node.js + node-cron                            |
| **Infra**    | Docker, Docker Compose                         |

---

## ğŸ“‹ ìš”êµ¬ì‚¬í•­

- Node.js 20+
- pnpm (ê¶Œì¥) ë˜ëŠ” npm
- Docker / Docker Compose
- PostgreSQL (ë¡œì»¬ì€ Dockerë¡œ ìë™ ìƒì„±)
- ì¹´ì¹´ì˜¤ ê°œë°œì ì•±
- êµ¬ê¸€ OAuth í´ë¼ì´ì–¸íŠ¸ (ì„ íƒ)

---

## ğŸš€ ë¡œì»¬ ê°œë°œ

### ê¶Œì¥ ë°©ì‹: Dockerë¡œ ì „ì²´ ì‹¤í–‰

```bash
# 1. í”„ë¡œì íŠ¸ í´ë¡ 
git clone https://github.com/qorlgns1/accommodation-monitor.git
cd accommodation-monitor

# 2. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
# OAuth í‚¤ ë° NEXTAUTH_SECRET ì…ë ¥

# 3. Docker ì‹¤í–‰
docker compose -f docker-compose.local.yml up --build

# 4. Prisma ìŠ¤í‚¤ë§ˆ ë°˜ì˜ (ìµœì´ˆ 1íšŒ)
pnpm local:docker:db:push

# 5. ë¸Œë¼ìš°ì € ì ‘ì†
open http://localhost:3000
```

### Docker ì—†ì´ ë¡œì»¬ ì‹¤í–‰

DBë§Œ Dockerë¡œ ì‹¤í–‰í•˜ê³  Next.jsëŠ” ë„¤ì´í‹°ë¸Œë¡œ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ë³¼ë¥¨ ë§ˆìš´íŠ¸ ì˜¤ë²„í—¤ë“œê°€ ì—†ì–´ ë” ë¹ ë¦…ë‹ˆë‹¤.

```bash
# 1. ì˜ì¡´ì„± ì„¤ì¹˜
pnpm install

# 2. DB ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -d \
  --name postgres-local \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD=postgres \
  -e POSTGRES_DB=accommodation_monitor_local \
  -p 5432:5432 \
  postgres:15

# 3. .envì—ì„œ DATABASE_URLì„ localhostë¡œ ì„¤ì •
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/accommodation_monitor_local

# 4. Prisma ìŠ¤í‚¤ë§ˆ ë°˜ì˜
pnpm prisma db push

# 5. ê°œë°œ ì„œë²„ ì‹¤í–‰
pnpm dev        # ì›¹ ì„œë²„ (http://localhost:3000)
pnpm cron       # ì›Œì»¤ (ë³„ë„ í„°ë¯¸ë„)
```

### OAuth Redirect URI ì„¤ì •

| Provider | Redirect URI                                     |
| -------- | ------------------------------------------------ |
| ì¹´ì¹´ì˜¤   | `http://localhost:3000/api/auth/callback/kakao`  |
| êµ¬ê¸€     | `http://localhost:3000/api/auth/callback/google` |

---

## ğŸ”§ í™˜ê²½ë³€ìˆ˜

### í•„ìˆ˜

| ë³€ìˆ˜                  | ì„¤ëª…                                       |
| --------------------- | ------------------------------------------ |
| `DATABASE_URL`        | PostgreSQL ì—°ê²° ë¬¸ìì—´                     |
| `NEXTAUTH_URL`        | ì„œë¹„ìŠ¤ URL                                 |
| `NEXTAUTH_SECRET`     | ì„¸ì…˜ ì•”í˜¸í™” í‚¤ (`openssl rand -base64 32`) |
| `KAKAO_CLIENT_ID`     | ì¹´ì¹´ì˜¤ REST API í‚¤                         |
| `KAKAO_CLIENT_SECRET` | ì¹´ì¹´ì˜¤ Client Secret                       |

### ì„ íƒ (OAuth)

| ë³€ìˆ˜                   | ì„¤ëª…                     |
| ---------------------- | ------------------------ |
| `GOOGLE_CLIENT_ID`     | êµ¬ê¸€ OAuth Client ID     |
| `GOOGLE_CLIENT_SECRET` | êµ¬ê¸€ OAuth Client Secret |

### Worker ì„¤ì •

| ë³€ìˆ˜                 | ì„¤ëª…              | ê¸°ë³¸ê°’         |
| -------------------- | ----------------- | -------------- |
| `CRON_SCHEDULE`      | ì‹¤í–‰ ì£¼ê¸° (cron)  | `*/30 * * * *` |
| `WORKER_CONCURRENCY` | ë™ì‹œ ì²˜ë¦¬ ìˆ™ì†Œ ìˆ˜ | `1`            |
| `BROWSER_POOL_SIZE`  | ë¸Œë¼ìš°ì € í’€ í¬ê¸°  | `1`            |

### ë¸Œë¼ìš°ì €/ì²´ì»¤ ì„¤ì • (v2.1.0+)

| ë³€ìˆ˜                    | ì„¤ëª…                           | ê¸°ë³¸ê°’             |
| ----------------------- | ------------------------------ | ------------------ |
| `NAVIGATION_TIMEOUT_MS` | ë„¤ë¹„ê²Œì´ì…˜ íƒ€ì„ì•„ì›ƒ (ms)       | `25000`            |
| `CONTENT_WAIT_MS`       | ì½˜í…ì¸  ë¡œë”© ëŒ€ê¸° ì‹œê°„ (ms)     | `10000`            |
| `PATTERN_RETRY_MS`      | íŒ¨í„´ ì¬í™•ì¸ ëŒ€ê¸° ì‹œê°„ (ms)     | `5000`             |
| `BLOCK_RESOURCE_TYPES`  | ì°¨ë‹¨í•  ë¦¬ì†ŒìŠ¤ íƒ€ì… (ì‰¼í‘œ êµ¬ë¶„) | `image,media,font` |

### Analytics / SEO (v2.2.0+)

| ë³€ìˆ˜                       | ì„¤ëª…                            |
| -------------------------- | ------------------------------- |
| `NEXT_PUBLIC_GA_ID`        | Google Analytics ì¸¡ì • ID        |
| `GOOGLE_SITE_VERIFICATION` | Google Search Console ì¸ì¦ ì½”ë“œ |
| `NAVER_SITE_VERIFICATION`  | ë„¤ì´ë²„ ì„œì¹˜ì–´ë“œë°”ì´ì € ì¸ì¦ ì½”ë“œ |

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì°¸ê³ 

ë¸Œë¼ìš°ì € 1ê°œë‹¹ ì•½ 150~300MBë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

| RAM | ê¶Œì¥ `BROWSER_POOL_SIZE` |
| --- | ------------------------ |
| 2GB | 1~2                      |
| 4GB | 2~3                      |

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
accommodation-monitor/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ api/                # API Routes
â”‚   â”‚   â”œâ”€â”€ login/              # ë¡œê·¸ì¸ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ dashboard/          # ëŒ€ì‹œë³´ë“œ
â”‚   â”‚   â””â”€â”€ accommodations/     # ìˆ™ì†Œ ê´€ë¦¬
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ auth.ts             # NextAuth ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ prisma.ts           # Prisma í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ checkers/           # Airbnb, Agoda ì²´ì»¤
â”‚   â”‚   â”œâ”€â”€ kakao/              # ì¹´ì¹´ì˜¤í†¡ ë©”ì‹œì§€
â”‚   â”‚   â””â”€â”€ cron/               # í¬ë¡  ì›Œì»¤
â”‚   â””â”€â”€ types/                  # TypeScript íƒ€ì…
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma           # DB ìŠ¤í‚¤ë§ˆ
â”œâ”€â”€ docker-compose.yml          # í”„ë¡œë•ì…˜
â”œâ”€â”€ docker-compose.local.yml    # ë¡œì»¬ ê°œë°œ
â””â”€â”€ package.json
```

---

## ğŸ¤ Contributing

í”„ë¡œì íŠ¸ì— ê¸°ì—¬í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ëª¨ë“  í˜•íƒœì˜ ê¸°ì—¬ë¥¼ í™˜ì˜í•©ë‹ˆë‹¤.

### ê¸°ì—¬ ë°©ë²•

1. ì´ ì €ì¥ì†Œë¥¼ Fork í•©ë‹ˆë‹¤
2. Feature ë¸Œëœì¹˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤ (`git checkout -b feature/amazing-feature`)
3. ë³€ê²½ì‚¬í•­ì„ ì»¤ë°‹í•©ë‹ˆë‹¤ (`git commit -m 'feat: Add amazing feature'`)
4. ë¸Œëœì¹˜ì— Push í•©ë‹ˆë‹¤ (`git push origin feature/amazing-feature`)
5. Pull Requestë¥¼ ìƒì„±í•©ë‹ˆë‹¤

### ì»¤ë°‹ ì»¨ë²¤ì…˜

[Conventional Commits](https://www.conventionalcommits.org/)ë¥¼ ë”°ë¦…ë‹ˆë‹¤.

```
feat: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€
fix: ë²„ê·¸ ìˆ˜ì •
docs: ë¬¸ì„œ ë³€ê²½
style: ì½”ë“œ í¬ë§·íŒ…
refactor: ì½”ë“œ ë¦¬íŒ©í† ë§
test: í…ŒìŠ¤íŠ¸ ì¶”ê°€/ìˆ˜ì •
chore: ë¹Œë“œ, ì„¤ì • ë³€ê²½
```

### ì´ìŠˆ & PR

- ë²„ê·¸ ë¦¬í¬íŠ¸ë‚˜ ê¸°ëŠ¥ ì œì•ˆì€ [Issues](https://github.com/qorlgns1/accommodation-monitor/issues)ì— ë“±ë¡í•´ì£¼ì„¸ìš”
- PR ì „ì— ê´€ë ¨ ì´ìŠˆê°€ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”

---

## ğŸ“„ ë¼ì´ì„¼ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” [MIT License](LICENSE)ë¡œ ë°°í¬ë©ë‹ˆë‹¤.

---

## ğŸ™ Acknowledgments

- [Puppeteer](https://pptr.dev/) - ì›¹ ìŠ¤í¬ë˜í•‘
- [Next.js](https://nextjs.org/) - React í”„ë ˆì„ì›Œí¬
- [Prisma](https://www.prisma.io/) - ORM
- [NextAuth.js](https://next-auth.js.org/) - ì¸ì¦
